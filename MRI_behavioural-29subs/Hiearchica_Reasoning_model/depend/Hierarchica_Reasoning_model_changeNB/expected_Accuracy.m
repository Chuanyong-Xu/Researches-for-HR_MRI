%% Expected accuracy function
function [A] = expected_Accuracy(Input, parameters, parameter_strings, SubjObj_flag);


% These equations are for measuring the expected accuracy. please refer to the supplementary and also Braden et al PNAS 2016 paper



% Gaussian pdf
pdf_x = @(x, mu, sigma) ((1/sqrt(2*pi*(sigma^2))) .* exp(-((x - mu).^2) / (2*(sigma^2))) );
Pr_I_Given_C_td = @(C, td, pDrift, pWm, pWm_offset, pBound_PrAn, pBound_AnPr, x_min, x_max, x_resolution) ((C==0)*sum(x_resolution*pdf_x(pBound_PrAn:x_resolution:x_max, pDrift*td, pWm*abs(td-.5)+pWm_offset)) + (C==1)*sum(x_resolution*pdf_x(x_min:x_resolution:pBound_AnPr, pDrift*td, pWm*abs(td-.5)+pWm_offset)) );
Pr_Anti_Given_C_td = @(C, td, pDrift, pWm, pWm_offset, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate, x_min, x_max, x_resolution) ( (pAlphaErr2 + (1-abs(pAlphaErr1)) * ((1-lapseRate)*Pr_I_Given_C_td(C, td, pDrift, pWm, pWm_offset, pBound_PrAn, pBound_AnPr, x_min, x_max, x_resolution)   + 0.5*lapseRate))  * (lapseRate<=1 && lapseRate>=0) * (pWm>0)  * (pAlphaErr1<1 && pAlphaErr1>=0) * (pAlphaErr2<1 && pAlphaErr2>=0));% * (pWm_offset>0)


% % % % % % td_DevValues = ([.01, 1/8, 1/4, 3/8, 1/2, 5/8, 3/4, 7/8, .99]); % changed by wenshan 20220412%********************************
td_DevValues = [0.1 0.3 0.5 0.7 0.9];%[0.01 1/4 1/2 3/4 0.99]; % [1/6 2/6 3/6 4/6 5/6]; %[0.0675, 5/16, 1/2, 11/16, .9325];%********************************


% only pAlphaErr1: randomly chose up or down    
Pr_tdm_given_I_C_td = @(tdm, reward, C, td, td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate) (...
                                     (C==0).* (reward==1 || reward==2).*(td>td_DevValues(3))  .*  ( ((1-(pAlphaErr1)).*(tdm>pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1)  +   (1-pAlphaErr1).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 ) +...
                                     (C==0).* (reward==1 || reward==2).*(td<td_DevValues(3))  .*  ( ((1-(pAlphaErr1)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1)  +   (1-pAlphaErr1) .*(tdm>pBound_PrAn) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 ) +...
                                     (C==0).* (reward==1 || reward==2).*(td==td_DevValues(3))  .* (0.5*( ((1-(pAlphaErr1)).*(tdm>pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 )  +  (1-pAlphaErr1) .*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 )   + 0.5*( ((1-(pAlphaErr1)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1)  +  (1-pAlphaErr1).*(tdm>pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 ) )+...
                                     (C==1).* (reward==1 || reward==2).*(td<td_DevValues(3))  .*  ( ((1-(pAlphaErr1)).*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1)  +   (1-pAlphaErr1) .*(tdm>pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 ) +...
                                     (C==1).* (reward==1 || reward==2).*(td>td_DevValues(3))  .*  ( ((1-(pAlphaErr1)).*(tdm>pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 )  +   (1-pAlphaErr1) .*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 ) +...
                                     (C==1).* (reward==1 || reward==2).*(td==td_DevValues(3))  .* ( 0.5*( ((1-(pAlphaErr1)).*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1)  +   (1-pAlphaErr1) .*(tdm>pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1)   + 0.5*( ((1-(pAlphaErr1)).*(tdm>pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 )  +  (1-pAlphaErr1) .*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +0.5*pAlphaErr1 ) ) ...
                                     +...
                                     (C==0).* (reward==2).*(td>td_DevValues(3))  .*  ( ((1-(pAlphaErr1)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +  0.5*pAlphaErr1 ) + ...
                                     (C==0).* (reward==2).*(td<td_DevValues(3))  .*  ( ((1-(pAlphaErr1)).*(tdm>pBound_PrAn) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +  0.5*pAlphaErr1 )+ ...
                                     (C==0).* (reward==2).*(td==td_DevValues(3))  .*  ( 0.5*( ((1-(pAlphaErr1)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +   0.5*pAlphaErr1 )  + 0.5*( ((1-(pAlphaErr1)).*(tdm>pBound_PrAn) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +  0.5*pAlphaErr1  )) +...
                                     (C==1).* (reward==2).*(td<td_DevValues(3))  .*  ( (1-(pAlphaErr1)).*(tdm>pBound_AnPr)  .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +   0.5*pAlphaErr1 ) + ...
                                     (C==1).* (reward==2).*(td>td_DevValues(3))  .*  ( (1-(pAlphaErr1)).*(tdm<=pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +   0.5*pAlphaErr1 ) +...
                                     (C==1).* (reward==2).*(td==td_DevValues(3))  .* (0.5*( (1-(pAlphaErr1)).*(tdm>pBound_AnPr)  .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +  0.5*pAlphaErr1 )  +0.5*( (1-(pAlphaErr1)).*(tdm<=pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +  0.5*pAlphaErr1   )) ...
                                 );
% pAlphaErr1 & pAlphaErr2                              
% Pr_tdm_given_I_C_td = @(tdm, reward, C, td, td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate) (...
%                                      (C==0).* (reward==1 || reward==2).*(td>td_DevValues(5))  .*  ( ((1-(pAlphaErr1)).*(tdm>pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  )  +   pAlphaErr2 .*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) ) +...
%                                      (C==0).* (reward==1 || reward==2).*(td<td_DevValues(5))  .*  ( ((1-(pAlphaErr2)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) )  +   pAlphaErr1 .*(tdm>pBound_PrAn) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  ) +...
%                                      (C==0).* (reward==1 || reward==2).*(td==td_DevValues(5))  .* (0.5*( ((1-(pAlphaErr1)).*(tdm>pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  )  +   pAlphaErr2 .*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  )   + 0.5*( ((1-(pAlphaErr2)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) )  +  (pAlphaErr1).*(tdm>pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  ) )+...
%                                      (C==1).* (reward==1 || reward==2).*(td<td_DevValues(5))  .*  ( ((1-(pAlphaErr1)).*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) )  +   pAlphaErr2 .*(tdm>pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) ) +...
%                                      (C==1).* (reward==1 || reward==2).*(td>td_DevValues(5))  .*  ( ((1-(pAlphaErr2)).*(tdm>pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  )  +   pAlphaErr1 .*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) ) +...
%                                      (C==1).* (reward==1 || reward==2).*(td==td_DevValues(5))  .* ( 0.5*( ((1-(pAlphaErr1)).*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) )  +   pAlphaErr2 .*(tdm>pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  )   + 0.5*( ((1-(pAlphaErr2)).*(tdm>pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  )  +   pAlphaErr1 .*(tdm<=pBound_AnPr).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate)  ) ) ...
%                                      +...
%                                      (C==0).* (reward==2).*(td>td_DevValues(5))  .*  ( ((1-(pAlphaErr1)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +   (pAlphaErr1) ) + ...
%                                      (C==0).* (reward==2).*(td<td_DevValues(5))  .*  ( ((1-(pAlphaErr2)).*(tdm>pBound_PrAn) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +   (pAlphaErr2) )+ ...
%                                      (C==0).* (reward==2).*(td==td_DevValues(5))  .*  ( 0.5*( ((1-(pAlphaErr1)).*(tdm<=pBound_PrAn).*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +   (pAlphaErr1) )  + 0.5*( ((1-(pAlphaErr2)).*(tdm>pBound_PrAn) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate))  +   (pAlphaErr2)  )) +...
%                                      (C==1).* (reward==2).*(td<td_DevValues(5))  .*  ( (1-(pAlphaErr1)).*(tdm>pBound_AnPr)  .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +   (pAlphaErr1) ) + ...
%                                      (C==1).* (reward==2).*(td>td_DevValues(5))  .*  ( (1-(pAlphaErr2)).*(tdm<=pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +   (pAlphaErr1)  ) +...
%                                      (C==1).* (reward==2).*(td==td_DevValues(5))  .* (0.5*( (1-(pAlphaErr1)).*(tdm>pBound_AnPr)  .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +   (pAlphaErr1) )  +0.5*( (1-(pAlphaErr2)).*(tdm<=pBound_AnPr) .*((1-lapseRate).*pdf_x(tdm, pDrift*td, pWm*abs(td-.5)+pWm_offset) + 0.5*lapseRate) +   (pAlphaErr1)   )) ...
%                                  );                             

% only pAlphaErr1: randomly chose up or down                          
Pr_F_given_C_tdm = @(tdm, C, td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate ) (...
                        ( (( Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(1), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(2), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(3), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(4), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(5), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5)) )  ...
                            ./ ...
                        ( (( Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(1), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(2), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(3), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(4), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(5), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, lapseRate)/5 ))) );
%********************************
% pAlphaErr1 & pAlphaErr2                    
% Pr_F_given_C_tdm = @(tdm, C, td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate ) (...
%                         ( (( Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(1), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(2), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(3), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(4), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(5), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(6), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(7), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(8), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 1, C, td_DevValues(9), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9 )) )  ...
%                             ./ ...
%                         ( (( Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(1), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(2), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(3), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(4), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(5), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(6), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(7), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(8), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9  +  Pr_tdm_given_I_C_td(tdm, 2, C, td_DevValues(9), td_DevValues, pWm, pWm_offset, pDrift, pBound_PrAn, pBound_AnPr, pAlphaErr1, pAlphaErr2, lapseRate)/9 )) ) );

    for iParameters = 1: length(parameter_strings)
       eval(parameter_strings{iParameters})
    end
    local_parameters.pDrift = 1; % The drift variable is no longer a free parameter in the psychometric function optimization and it's set to 1 everywhere.

    td_min = -5; td_resolution = 0.01; td_max = 5;
    for iTrial = 1: length(Input.tDev) % integrating over tm (measured sample interval). 
        tdm = td_min:td_resolution:td_max; 
        
        for itdm = 1: length(tdm)
           % only pAlphaErr1: randomly chose up or down
            A_1(itdm) = Pr_F_given_C_tdm(tdm(itdm), Input.RuleChoice(iTrial), td_DevValues, local_parameters.pWm, local_parameters.pWm_offset, local_parameters.pDrift, local_parameters.pBound_PrAn, local_parameters.pBound_AnPr, local_parameters.pAlphaErr1, local_parameters.lapseRate) ;
           % pAlphaErr1 & pAlphaErr2
           % A_1(itdm) = Pr_F_given_C_tdm(tdm(itdm), Input.RuleChoice(iTrial), td_DevValues, local_parameters.pWm, local_parameters.pWm_offset, local_parameters.pDrift, local_parameters.pBound_PrAn, local_parameters.pBound_AnPr, local_parameters.pAlphaErr1, local_parameters.pAlphaErr2, local_parameters.lapseRate) ;
           
           A_2(itdm) = pdf_x(tdm(itdm),    local_parameters.pDrift * (Input.tDev(iTrial)),   local_parameters.pWm * (abs(Input.tDev(iTrial)-.5)) + local_parameters.pWm_offset );
        end
        A(iTrial) = sum(A_1 .* A_2)*td_resolution;
    end

   
end
